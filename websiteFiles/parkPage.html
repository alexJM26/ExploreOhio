<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- CSS -->
    <link href="css_files/style.css" rel="stylesheet">
    <link href="css_files/forms.css" rel="stylesheet">
    <link href="css_files/functionality.css" rel="stylesheet">
    <title>Explore Ohio</title>

    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow-x: hidden; 
            background-color: #A4B465;
        }

        #parkInfo .col-md-6,
        #parkInfo .col-md-5 {
            background-color: #A4B465;
        }

        .custom-divider {
            background-color: #FEFAE0;
            min-height: 100vh;
        }


        .full-height {
            height: 100%;
        }

        .green-panel {
            background-color: #A4B465;
            padding: 40px;
        }

        .cream-divider {
            background-color: #FEFAE0;
            width: 1em;
            padding: 0;
        }

        h2, a.problem-link {
            color: white;
        }

        .problem-link {
            font-weight: bold;
            text-decoration: none;
        }

        .problem-link:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid px-6">
            <img src="images/logo.svg" style="height: 50px">
            <a class="navbar-brand" href="index.html" style="font-size: 1.75em; font-weight: bold">Explore Ohio</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav ms-auto">
                    <a class="nav-link" href="explore.html"> Explore Top Parks </a>
                    <a class="nav-link" href="review.html"> Review a Park </a>
                    <a class="nav-link" href="submit.html"> Submit Your Own Park </a>
                    <a class="nav-link" href="handy.html"> Handy Resources </a>
                    <a class="nav-link" href="map.html"> Interactive Map</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Full-height Container -->
    <div class="container-fluid h-100 px-0">
        <div id="parkInfo" class="row full-height align-items-stretch" style="padding-top: 65px;"></div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const parkId = urlParams.get('id');

        const parkInfoContainer = document.getElementById('parkInfo');

        function showStars(stars) {
            let html = '';
            for (let i = 1; i <= 5; i++) {
                html += `<img src="images/${stars >= i ? 'starFilled' : 'starEmpty'}.svg" style="height: 30px; margin-right: 5px;"> `;
            }
            return html;
        }

        Promise.all([
            fetch('data/parks.json').then(res => res.json()),
            fetch('data/reviews.json').then(res => res.json())
        ]).then(([parks, reviews]) => {
            const park = parks.find(p => p.id === parkId);
            const parkReviews = reviews.filter(r => r.parkId === parkId);

            if (!park) {
                parkInfoContainer.innerHTML = '<p>Park not found.</p>';
                return;
            }

            // LEFT: Info and reviews
            const infoCol = document.createElement('div');
            infoCol.className = 'col-md-6 green-panel';
            infoCol.style.height = '100%';

            const title = `<h2 class="text-left" style="font-size: 3.0em; font-weight: bold"> ${park.name} </h2>`;
            const stars = `
                <div class="mb-2 d-flex align-items-center">
                    <div class="d-flex">
                        ${showStars(park.rating.value)}
                    </div>
                    <div class="ms-2" style="font-size: 1.5em; line-height: 1; display: flex; align-items: center; color: white;">
                        ${park.rating.value.toFixed(1)}
                    </div>
                </div>
            `;
            const address = `<p class="text-muted"><i class="bi bi-geo-alt-fill"></i>  ${park.location.latitude}, ${park.location.longitude}</p>`;

            const tags = `
                <div class="tags-container mb-3">
                    ${park.tags.map(tag => `<span class="tags me-2 mb-2">${tag}</span>`).join('')}
                </div>
            `;

            const reviewsHTML = parkReviews.map(r => `
                <div class="bg-light p-3 my-2 rounded">
                    ${showStars(r.stars)}
                    <p class="mt-2">${r.text}</p>
                </div>
            `).join('');

            infoCol.innerHTML = `
                ${title}
                ${stars}
                ${address}
                <div class="mb-3">${tags}</div>

                <h4>Reviews (${parkReviews.length})</h4>
                <a href="review.html?parkName=${encodeURIComponent(park.name)}" class="btn btn-warning mb-4">Leave a Review!</a>
                ${reviewsHTML || '<p>No reviews yet.</p>'}
            `;

            // MIDDLE: Divider bar
            const divider = document.createElement('div');
            divider.className = 'col-md-1 cream-divider';
            divider.style.height = '100%';

            // RIGHT: Photos
            const imageCol = document.createElement('div');
            imageCol.className = 'col-md-5 green-panel';
            imageCol.style.height = '100%';
            const photoList = ['a', 'b', 'c'].map(letter => {
                const photoPath = `data/photos/${park.id}-${letter}.jpg`;
                return `<img src="${photoPath}" class="img-fluid mb-3 rounded shadow" style="max-width: 100%; height: auto;" onerror="this.style.display='none'">`;
            }).join('');
            imageCol.innerHTML = photoList;

            parkInfoContainer.appendChild(infoCol);
            parkInfoContainer.appendChild(divider);
            parkInfoContainer.appendChild(imageCol);
        });
    </script>

</body>
</html>